"use strict";
function set(object, path, value, deleteIfUndefined = false) {
  if (object == null)
    return object;
  const segments = path.split(/[.[\]]/g);
  if (segments[0] === "")
    segments.shift();
  if (segments.at(-1) === "")
    segments.pop();
  const apply = (node) => {
    if (segments.length > 1) {
      const key = segments.shift();
      const nextIsNumber = !Number.isNaN(Number.parseInt(segments[0], 10));
      if (node[key] === void 0) {
        node[key] = nextIsNumber ? [] : {};
      }
      apply(node[key]);
    } else {
      if (deleteIfUndefined && value === void 0) {
        delete node[segments[0]];
        return;
      }
      node[segments[0]] = value;
    }
  };
  apply(object);
  return object;
}
module.exports = set;
