!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports["easy-web-worker"]=n():e["easy-web-worker"]=n()}(this,(()=>(()=>{var e={416:(e,n)=>{"use strict";var t;Object.defineProperty(n,"__esModule",{value:!0}),n.uniqueId=void 0,n.uniqueId=(t=0,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t===Number.MAX_SAFE_INTEGER&&(t=0),e+Date.now().toString(36)+(t++).toString(36)})},816:function(e){var n;n=()=>(()=>{"use strict";var e={0:(e,n,t)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.toCancelablePromise=n.CancelablePromise=void 0;var o,c=t(836),i=t(216),a=t(790);function u(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(c=function(e){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,"string");if("object"!==r(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(c)?c:String(c)),o)}var c}function l(e){var n=d();return function(){var t,o=y(e);if(n){var c=y(this).constructor;t=Reflect.construct(o,arguments,c)}else t=o.apply(this,arguments);return function(e,n){if(n&&("object"===r(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return s(e)}(this,t)}}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,n,t){var r=function(e,n){for(;!Object.prototype.hasOwnProperty.call(e,n)&&null!==(e=y(e)););return e}(e,n);if(r){var o=Object.getOwnPropertyDescriptor(r,n);return o.get?o.get.call(arguments.length<3?e:t):o.value}},f.apply(this,arguments)}function p(e){var n="function"==typeof Map?new Map:void 0;return p=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,r)}function r(){return b(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),v(r,e)},p(e)}function b(e,n,t){return b=d()?Reflect.construct.bind():function(e,n,t){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(e,r));return t&&v(o,t.prototype),o},b.apply(null,arguments)}function d(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function v(e,n){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,n){return e.__proto__=n,e},v(e,n)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}var m=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&v(e,n)}(i,e);var n,t,r=l(i);function i(e){var n,t,a,u,l,p;return function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,i),(u=r.call(this,(function(e,n){l=e,p=n})))[o]=!0,u.status="pending",u.cancelCallbacks=new Set,u.ownCancelCallbacks=new Set,u.onProgressCallbacks=new Set,u.disposeCallbacks=function(){u.cancelCallbacks=new Set,u.ownCancelCallbacks=new Set,u.onProgressCallbacks=new Set},u.subscribeToOwnCancelEvent=function(e){return u.ownCancelCallbacks.add(e),function(){u.ownCancelCallbacks.delete(e)}},u.cancel=function(e){if("pending"!==u.status)return s(u);u.status="canceled";var n=void 0===e?new Error("Promise canceled"):e;return u.ownCancelCallbacks.forEach((function(e){return e(n)})),u.cancelCallbacks.forEach((function(e){return e(n)})),u._reject(n),u.disposeCallbacks(),s(u)},u.onCancel=function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).signal;return u.cancelCallbacks.add(e),(0,c.isCancelableAbortSignal)(n)?n.subscribe((function(){u.cancelCallbacks.delete(e)})):null==n||n.addEventListener("abort",(function(){u.cancelCallbacks.delete(e)})),s(u)},u.onProgress=function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).signal;return u.onProgressCallbacks.add(e),(0,c.isCancelableAbortSignal)(n)?n.subscribe((function(){u.onProgressCallbacks.delete(e)})):null==n||n.addEventListener("abort",(function(){u.onProgressCallbacks.delete(e)})),s(u)},u.reportProgress=function(e,n){return u.onProgressCallbacks.forEach((function(t){return t(e,n)})),s(u)},u.createChildPromise=function(){var e,n,t=new i((function(t,r,o){e=t,n=r}));return t.onProgressCallbacks=u.onProgressCallbacks,t.onCancel((function(e){u.cancel(e)})),{promise:t,resolve:e,reject:n}},u._resolve=l,u._reject=p,e((function(e){u.status="resolved",u.disposeCallbacks(),u._resolve(e)}),(function(e){u.status="rejected",u.disposeCallbacks(),u._reject(e)}),{cancel:function(e){return u.cancel(e)},onCancel:function(e){return u.subscribeToOwnCancelEvent(e)},onProgress:function(e){return u.onProgress(e),function(){u.onProgressCallbacks.delete(e)}},reportProgress:function(e,n){u.reportProgress(e,n)}}),u.then=function(e,t){var r=u.createChildPromise(),o=r.promise,c=r.resolve,a=r.reject;return f((n=s(u),y(i.prototype)),"then",n).call(n,e,t).then(c,a),o},u.catch=function(e){var n=u.createChildPromise(),r=n.promise,o=n.resolve,c=n.reject;return f((t=s(u),y(i.prototype)),"catch",t).call(t,e).then(o,c),r},u.finally=function(e){var n=u.createChildPromise(),t=n.promise,r=n.resolve,o=n.reject;return f((a=s(u),y(i.prototype)),"finally",a).call(a,e).then(r,o),t},u}return n=i,t=[{key:"resolve",value:function(e){return new i((function(n){return n(e)}))}}],t&&u(n,t),Object.defineProperty(n,"prototype",{writable:!1}),i}(p(Promise));n.CancelablePromise=m,o=i.promise_identifier,m.reject=function(e){return new m((function(n,t){return t(e)}))},m.canceled=function(e){return new m((function(n,t,r){return(0,r.cancel)(e)}))},m.race=function(e){return new m((function(n,t,r){var o=r.onCancel,c=r.cancel;e.forEach((function(e){var r=P(e);o((function(e){r.cancel(e)})),r.then(n,(function(e){"canceled"!==r.status?t(e):c(e)}))}))}))},m.all=function(e){return new m((function(n,t,r){var o=r.onCancel,c=r.cancel,i=new Map,a=e.length,u=0;e.forEach((function(e){var r=P(e);i.set(r,null),o((function(e){r.cancel(e)})),r.then((function(e){u++,i.set(r,e),u===a&&n(Array.from(i.values()))}),(function(e){"canceled"!==r.status?t(e):c(e)}))}))}))},m.allSettled=function(e){return new m((function(n,t,r){var o=r.onCancel,c=new Map,i=e.length,a=0;e.forEach((function(e){var t=P(e);c.set(t,null),o((function(e){t.cancel(e)})),t.then((function(e){c.set(t,{status:"fulfilled",value:e})}),(function(e){c.set(t,{status:"canceled"===t.status?"canceled":"rejected",reason:e})})).finally((function(){++a===i&&n(Array.from(c.values()))}))}))}))},m.prototype.constructor=Promise;var P=function e(n){if((0,i.isCancelablePromise)(n))return n;if("function"==typeof n)return e(n());if(!(0,a.isPromise)(n))return new m((function(e){return e(n)}));var t,r,o=new m((function(e,o,c){t=e,r=o,n.then(t,r)}));return o.onCancel((function(e){r(e)})),o};n.toCancelablePromise=P},836:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isCancelableAbortSignal=void 0,n.isCancelableAbortSignal=function(e){return Boolean(null==e?void 0:e.__is_cancelable_abort_signal)}},216:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.promise_identifier=n.isCancelablePromise=void 0;var t=Symbol("promise_identifier");n.promise_identifier=t,n.isCancelablePromise=function(e){return!!(null==e?void 0:e[t])}},790:(e,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isPromise=void 0,n.isPromise=function(e){return Promise.resolve(e)===e}}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var c=n[r]={exports:{}};return e[r](c,c.exports,t),c.exports}var r={};return(()=>{var e=r;Object.defineProperty(e,"__esModule",{value:!0}),e.createDecoupledPromise=void 0;var n=t(0);e.createDecoupledPromise=function(){var e,t,r,o=new n.CancelablePromise((function(n,o,c){e=n,t=o,r=c}));return Object.assign(Object.assign({resolve:e,reject:t},r),{promise:o})}})(),r})(),e.exports=n()}},n={};function t(r){var o=n[r];if(void 0!==o)return o.exports;var c=n[r]={exports:{}};return e[r].call(c.exports,c,c.exports,t),c.exports}var r={};return(()=>{"use strict";var e=r;function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i(r.key),r)}}function c(e,n,t){return n&&o(e.prototype,n),t&&o(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}Object.defineProperty(e,"__esModule",{value:!0}),e.EasyWebWorkerMessage=void 0;var a=t(816),u=t(416),l=c((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.messageId=(0,u.uniqueId)("ms:"),this.decoupledPromise=(0,a.createDecoupledPromise)(),this.decoupledPromise._cancel=this.decoupledPromise.promise.cancel}));e.EasyWebWorkerMessage=l})(),r})()));