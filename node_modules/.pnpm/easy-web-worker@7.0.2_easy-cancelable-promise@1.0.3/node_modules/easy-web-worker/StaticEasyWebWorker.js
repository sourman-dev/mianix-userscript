!function(e,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports["easy-web-worker"]=o():e["easy-web-worker"]=o()}(this,(()=>(()=>{"use strict";var e={};return(()=>{var o=e;function r(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,o){if(e){if("string"==typeof e)return n(e,o);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,o):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,o){(null==o||o>e.length)&&(o=e.length);for(var r=0,n=Array(o);r<o;r++)n[r]=e[r];return n}Object.defineProperty(o,"__esModule",{value:!0}),o.StaticEasyWebWorker=void 0,o.StaticEasyWebWorker=function(e){var o=function(){var e=new Map,o=new Map([["",function(){throw"you didn't defined a message-callback, please assign a callback by calling easyWorker.onMessage"}]]);self.onmessage=function(r){var n,t,a,s,i=null===(n=null==r?void 0:r.data)||void 0===n?void 0:n.messageId,c=null!==(a=null===(t=null==r?void 0:r.data)||void 0===t?void 0:t.__is_easy_web_worker_message__)&&void 0!==a&&a;if(i&&c)try{var l=r.data.cancelation;if(l){var d=l.reason;return void e.get(i).cancel(d)}var u=r.data,g=u.method,f=function(o){var r=o.messageId,n=o.payload,t=o.method,a="pending",s=new Map,i=function(o,n){var i,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=a,d="progress"===o?"pending":o;if(e.has(r)){var u={resolved:"onResolve",rejected:"onReject",canceled:"onCancel",worker_cancelation:"onCancel",pending:"onProgress"}[d],g=s.get(u),f=!n.progress;try{null==g||g.forEach((function(e){return e(n,c)})),f&&(null===(i=s.get("onFinalize"))||void 0===i||i.forEach((function(e){return e(n,c)})))}catch(t){throw e.delete(r),{message:"Error while processing message id: "+r,error:t,messageData:n,messageType:o,when:u}}finally{f&&e.delete(r)}self.postMessage(Object.assign({messageId:r},n),c),a=d}else{var p="%c#"+r+" Message Not Found: %cThis means that the message was already resolved | rejected | canceled. To avoid this error, please make sure that you are not resolving | rejecting | canceling the same message twice. Also make sure that you are not reporting progress after the message was processed. Remember each message can handle his one cancelation by adding a handler with the %cmessage.onCancel%c method. To now more about this method, please check the documentation at: %chttps://www.npmjs.com/package/easy-web-worker#ieasywebworkermessageipayload--null-iresult--void %cTrying to process message:";console.error(p,"color: darkorange; font-size: 12px; font-weight: bold;","font-weight: normal;","font-weight: bold;","font-weight: normal;","color: lightblue; font-size: 10px; font-weight: bold;","font-weight: bold; color: darkorange;",{messageId:r,status:{current:l,target:d},method:t,action:n})}},c=function(e){return function(o){s.has(e)||s.set(e,new Set);var r=s.get(e);return r.add(o),function(){return r.delete(o)}}};return{messageId:r,method:t,payload:n,getStatus:function(){return a},isPending:function(){return"pending"===a},resolve:function(e){return i("resolved",{resolved:{payload:void 0===e?[]:[e]}},arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])},reject:function(e){i("rejected",{rejected:{reason:e}},arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])},cancel:function(e){return i("worker_cancelation",{worker_cancelation:{reason:e}},arguments.length>1&&void 0!==arguments[1]?arguments[1]:[])},reportProgress:function(e,o){i("progress",{progress:{percentage:e,payload:o}},arguments.length>2&&void 0!==arguments[2]?arguments[2]:[])},onResolve:c("onResolve"),onReject:c("onReject"),onCancel:c("onCancel"),onProgress:c("onProgress"),onFinalize:c("onFinalize")}}({method:g,messageId:i,payload:u.execution.payload});e.set(i,f),o.get(g||"")(f,r)}catch(o){throw e.delete(null===(s=r.data)||void 0===s?void 0:s.messageId),{message:"Error while processing message id: "+i,event:r}}};return{onMessage:function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];var t=r[0],a=r[1];if("string"==typeof t){var s=t,i=a;o.set(s,i)}else{var c=t;o.set("",c)}},close:function(){r(e.values()).forEach((function(e){return e.reject(new Error("worker closed"))})),self.close()},importScripts:function(){var e;(e=self).importScripts.apply(e,arguments)}}}(),n=o.close,t=o.onMessage,a=o.importScripts;this.close=n,this.onMessage=t,this.importScripts=a,e&&t(e)}})(),e})()));